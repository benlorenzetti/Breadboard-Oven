\documentclass[10pt, twocolumn]{article}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage{nicefrac}
\usepackage{verbatim}
\usepackage{amsmath}
\usepackage{nicefrac}
\usepackage[colorlinks=false, hidelinks]{hyperref}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{color}
\usepackage[dvipsnames]{xcolor}
\usepackage{tikz}
\usetikzlibrary{shapes, snakes, arrows, automata, positioning}
\usepackage[american]{circuitikz}

\definecolor{mygray}{rgb}{.9,.9,.9}
\lstset{ %
	breaklines=true
	language=[x86masm]Assembler,
  	backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
	numberstyle=\small\color{mygray}, % the style that is used for the line-numbers
	numbers=none,                    % where to put the line-numbers; possible values are (none, left, right)
}


\title{%
	\makebox[\textwidth][s]{%
		\hfill
		\begin{tabular}[b]{@{}c@{}}
				\fontsize{14}{20}\bfseries\selectfont \emph{Easy--PCB} Solder Reflow Oven\\
				\fontsize{12}{18}\selectfont Ben Lorenzetti \& Adam Meece\\
 		\end{tabular}%
    		\hfill
    		\makebox[0pt][r]{%
      			\includegraphics[width=0.2\textwidth]{Figures/aluminum-frame-concept.pdf}}%
 	}% end makebox
}% end title

\author{}
\date{}

\begin{document}

\maketitle

\section*{Features}
\addcontentsline{toc}{section}{Features}

\begin{flushleft}
	\begin{itemize}
		\fontsize{10}{12}\bfseries\selectfont
		\item Insulated aluminum frame with 6"x6"x10" interior chamber
		\item 400 Watt nichrome heating element with door safety switch
		\item 120 VAC power supply with surge and short protection
		\item Forced convection fan driven by bipolar stepper motor
		\item Type K thermocouple for temperature feedback loop
		\item PIC18F14K50 based control
		\item Convenient \mbox{7--segment} display and pushbutton user interface
	\end{itemize}
\end{flushleft}

\section*{Introduction}
\addcontentsline{toc}{section}{Introduction}

\emph{Easy--PCB} is a small, desktop convection oven for DIY reflow soldering at home.

As integrated circuits continue to become smaller and faster,
many $\mu$Controllers, FPGAs, and other ICs are no longer available in
DIP form for breadboard prototyping or iron soldering.
Similar to the shift away from PC parallel ports in the early 2000s,
the shift away from DIPs means modern electronics hobbyists need more
complicated equipment than their predessesors.

Currently, commercial solder reflow stations are available for
soldering fine pitch, SMD, and BGA componenets.
More recently, several hackers have created open source designs
for inexpensive reflow ovens, using converted kitchen toaster ovens.

\emph{Easy--PCB} is better because it is a convection oven;
controlled air flow prevents parts from being blown out of position and
convection heating obviates the uneven heat absorbtion seen in infrared radiation based systems.
Furthermore, \emph{Easy--PCB} was designed from the ground up for soldering,
so the heating elements and oven frame were optimized alongside the
temperature controller for a typical solder reflow profile.

\begin{center}
	\includegraphics[width=\columnwidth]{Figures/control-system.pdf}
	\captionof*{figure}{The \emph{Easy--PCB} Control System: not just a controller bolted onto a disjoint oven.}
\end{center}

\emph{Easy--PCB} allows hobbyists to produce reflow temperature profiles with
a high degree of accuracy and repeatability.
Alongside freely available PCB design programs like Eagle and low-quantity
fabrication services like OSH Park, \emph{Easy--PCB} makes
modern integrated components, such as digital CMOS cameras,
within the design space of hobbyists and hackers.

\begin{center}
	\includegraphics[width=\columnwidth]{Figures/control-results.pdf}
	\captionof*{figure}{Faithful Temperature Profile Control}
\end{center}

\tableofcontents

\section{User Interface}

\emph{Easy--PCB} presents temperature and time information on a four digit LED display.
After pressing the green `start' button, the current temperature and process
runtime are alternately displayed every second.

\begin{center}
	\begin{minipage}[b]{0.45\columnwidth}
		\centering
		\includegraphics[width=\textwidth]{Figures/clock-display.pdf}
	\end{minipage}
	\begin{minipage}[b]{0.45\columnwidth}
		\centering
		\includegraphics[width=\textwidth]{Figures/temperature-display.pdf}
	\end{minipage}	
%	\captionof*{figure}{Time and Temperature Displays}
\end{center}

The red `stop' button can be pressed at anytime to quit the current process
or reset the microcontroller.

\begin{center}
	\begin{tikzpicture}[font=\fontsize{10pt}{11pt}\selectfont]
		\node [draw, thick,fill=black] (left) at (0cm, 0.5cm) {\textcolor{white}{$\leftarrow$}};
		\node [draw, thick,fill=black] (right) at (1.5cm, .5cm) {\textcolor{white}{$\rightarrow$}};
		\node [draw, thick, fill=black] (up) at (0.75cm, 1cm) {\textcolor{white}{$\uparrow$}};
		\node [draw, thick, fill=black] (down) at (0.75cm, 0cm) {\textcolor{white}{$\downarrow$}};
		\node [draw, thick, fill=ForestGreen] (start) at (2.75cm, 1cm) {\textcolor{white}{Start}};
		\node [draw, thick, fill=red] (stop) at (2.75cm, 0cm) {\textcolor{white}{Stop}};
	\end{tikzpicture}
	\captionof*{figure}{Pushbutton Interface}
\end{center}

Set point programming with the 4 nav keys is used to enter a time--temperature profile.
Use the `left' and `right' keys to move between set points and the `up' and `down'
keys to edit each set point value.

\begin{center}
	\begin{tikzpicture}[font=\fontsize{8pt}{9pt}\selectfont]
		\path [draw, -latex', thick] (1cm, 4cm) -- (1cm, 7.5cm);
		\path [draw, -latex', thick] (1cm, 4cm) -- (6.5cm, 4cm);
		\path [draw, thick] (1cm, 4cm) -- (1.5cm, 5cm);
		\path [draw, thick] (3cm, 5.5cm) -- (1.5cm, 5cm);
		\path [draw, thick, dashed] (3cm, 5.5cm) -- (3.5cm, 6.5cm);
		\path [draw, thick, dashed] (4cm,7cm) -- (3.5cm, 6.5cm);
		\path [draw, thick, dashed] (4cm,7cm) -- (4.5cm, 6.5cm);
		\path [draw, thick, dashed] (5.5cm,4cm) -- (4.5cm, 6.5cm);
		\node [draw, thick] (tzero) at (0cm, 2cm) {$0s$};
		\node [draw, thick] (Tzero) at (1cm, 2cm) {$20^{o}$};
		\path [draw, -latex', thick] (tzero) -- (Tzero);
		\node [draw, thick] (tone) at (2cm, 2cm) {$t_{1}$};
		\path [draw, -latex', thick] (Tzero) -- (tone);
		\node [draw, thick] (Tone) at (3cm, 2cm) {$T_{1}$};
		\path [draw, -latex', thick] (tone) -- (Tone);
		\node [draw, thick] (ttwo) at (4cm, 2cm) {$t_{2}$};
		\path [draw, -latex', thick] (Tone) -- (ttwo);
		\node [draw, thick] (Ttwo) at (5cm, 2cm) {$T_{2}$};
		\path [draw, -latex', thick] (ttwo) -- (Ttwo);
		\node [draw, thick] (tn) at (6.5cm, 2cm) {$t_{n}$};
		\path [draw, -latex', thick, dashed] (Ttwo) -- (tn);
		\node [draw, thick] (Tn) at (7.5cm, 2cm) {$20^{o}$};
		\path [draw, -latex', thick] (tn) to (Tn);
		\path [draw, thick] (Tn) -- (7.5cm, 0.5cm);
		\path [draw, thick] (7.5cm, 0.5cm) -- (0cm, 0.5cm);
		\path [draw, -latex', thick] (0cm,0.5cm) -- (tzero);
		\path [draw, -latex', thick] (tone) -- (2cm, 2.5cm);
		\path [draw, -latex', thick] (tone) -- (2cm, 1.5cm);
		\path [draw, -latex', thick] (Tone) -- (3cm, 2.5cm);
		\path [draw, -latex', thick] (Tone) -- (3cm, 1.5cm);
		\path [draw, -latex', thick] (ttwo) -- (4cm, 2.5cm);
		\path [draw, -latex', thick] (ttwo) -- (4cm, 1.5cm);
		\node (TtwoMax) at (5cm, 2.75cm) {$275^{o}C$};
		\node (TtwoMin) at (5cm, 1.25cm) {$20^{o}C$};
		\node (tnMax) at (6.5cm, 2.75cm) {$(t_{n-1}+255s)$};
		\node (tnMin) at (6.5cm, 1.25cm) {$t_{n-1}$};
		\path [draw, -latex', thick] (Ttwo) -- (TtwoMax);
		\path [draw, -latex', thick] (Ttwo) -- (TtwoMin);
		\path [draw, -latex', thick] (tn) -- (tnMax);
		\path [draw, -latex', thick] (tn) -- (tnMin);
		\node (t1label) at (1.5cm, 3.5cm) {$t_{1}$};
		\node (t2label) at (3cm, 3.5cm) {$t_{2}$};
		\node (tnlabel) at (5.5cm, 3.5cm) {$t_{n}$};
		\node (T1label) at (0.5cm, 5cm) {$T_{1}$};
		\node (T2label) at (0.5cm, 5.5cm) {$T_{2}$};
		\path [draw, dashed] (t1label) -- (1.5cm, 5cm);
		\path [draw, dashed] (t2label) -- (3cm, 5.5cm);
		\path [draw, dashed] (T1label) -- (1.5cm, 5cm);
		\path [draw, dashed] (T2label) -- (3cm, 5.5cm);
		\path [draw, dashed] (tnlabel) -- (5.5cm, 4cm);
		\node (Tlabel) at (0.25cm, 7cm) {$T\,(^{o}C)$};
		\node (tlabel) at (6.5cm, 3.5cm) {$\textrm{time}\,(s)$};
	\end{tikzpicture}
	\captionof*{figure}{Set Point Programming}
	\label{set-point-programming}
\end{center}

A total of 128 set points can be entered. The first set point is always $(0s,\,20^{o}C)$,
and the process will terminate at the next occurance of $20^{o}$ in a point.
Temperatures can take any value in the range \mbox{$20^{o}C<T<275^{o}C=527^{o}F$.}
The time between two points must be between \mbox{$0<=t<255$ seconds.}

\section{Plant Design}

\subsection{Temperature Objectives}

\begin{figure*}
	\centering
	\includegraphics[width=0.7\textwidth]{Figures/standard-reflow-profile.pdf}
	\caption{Standard Solder Reflow Profile, per \href{J-STD-020D-1.pdf}{IPC/JEDEC STD-1-020D.1}}
	\label{standard-reflow-profile}
\end{figure*}

A typical solder reflow profile is shown in
\hyperref[standard-reflow-profile]{\mbox{figure \ref{standard-reflow-profile}}}.
The optimal shape and peak temperature depend on the components and,
more significantly, on the use of leaded solder.
\begin{equation*}
T_{p}\approx T_{c}=\left\{\begin{array}{c c}
220-235^{o}C	&\textrm{Leaded solder}	\\
245-260^{o}C	&\textrm{Pb--free}	\\
\end{array}\right.
\end{equation*}
\begin{equation*}
t_{p}=\left\{\begin{array}{c c}
20s	&\textrm{Leaded solder}	\\
30s	&\textrm{Pb--free}	\\
\end{array}\right.
\end{equation*}

\emph{Easy--PCB} was designed from the ground up for faithfully producing these
reflow profiles. This design process for the thermodynamic system is detailed below.

\subsection{Thermodynamics Theory}

\textbf{Heat} is everyone's least favorite form of energy because it
tends to dissipate everywhere and is difficult to transform into useful work.
Nevertheless, it is a form of energy so it is measured in joules.
\begin{equation*}
Q:=\textrm{Heat}\,[\textrm{Joules}]
\end{equation*}

From a microscopic view, heat is the kinetic energy of gas molecules or the
vibrational energy of bonds in solids. In both cases, summed over every
molecule, every bond, and every vibrational mode in the system.

\begin{center}
	\includegraphics[width=1\columnwidth]{Figures/microscopic-view.pdf}
	\captionof{figure}{Heat Energy on a Molecular Scale}
	\label{microscopic-view}
\end{center}

\textbf{Temperature} is a potential field that measures an objects
tendancy to give up or absorb heat.
On average, heat always flows from regions of hotter temperature temperature
to lower temperature.
Temperature is usually measured in Kelvin or Celsius, which are related by
\begin{equation*}
T_{\textrm{Celsius}}=T_{\textrm{Kelvin}}+273.16.
\end{equation*}

Another way to think of temperature is a measure of heat density that also
incorporates the types of bonds (or lack thereof) in which heat energy is stored.
For example, a glacier contains more heat than a pot of boiling water, but
has a much lower heat density.

The relationship between temperature and heat stored in an object is given by
\begin{equation}
dQ=mc_{p}dT,
\label{specific-heat-eq}
\end{equation}
where $c_{p}$ is the specific heat of the material with units $\left[\frac{kJ}{kg*K}\right]$.

So heat flows spontaneously to reduce
temperature gradients, but how does heat flow and at what rate?
There are three mechanisms of heat transfer:
\emph{conduction}, \emph{convection}, and \emph{radiation}.

\textbf{Conduction} of heat is caused by molecular interactions,
such as the push--pull of nearby atomic bonds in solids or
elastic collisions between molecules of air.

The empirical relation for conduction is Fourier's Law, which
says the rate of heat transfer due to conduction is proportional
to both the difference in temperature and the media:
\begin{equation*}
\vec{q}=k\vec{\nabla}T
\end{equation*}
where $\vec{q}$ is the rate of heat transfer per unit surface area
and $k$ is the thermal conductivity of the medium with units
$\left[\frac{W}{m*K}\right]$.

In integral form, Fourier's Law is
\begin{equation*}
\frac{\delta Q}{\delta t}=k\oint_{S}\vec{\nabla}T*d\vec{A}.
\end{equation*}

And, in the one dimensional case,
\begin{equation}
\frac{\delta Q}{\delta t}=-kA\frac{\delta T}{\delta x}.
\label{1D-fouriers-law-eq}
\end{equation}

\textbf{Convection} is the second mechanism of heat transfer,
involving the bulk movement of particles driven by diffusion.

Every air molecule is moving in a random direction with random
kinetic energy, but a region of air with higher average kinetic
energy (temperature) will see more molecules leaving than entering
on average, because those leaving are moving faster than those
entering.

Note that in convection, no molecules gain or lose energy;
molecules of different energy simply trade places.

If a fan is used to apply work to a gas, the rate of convection
increases and then Newtons' Law of Cooling can predict the
rate of convection in gas near a solid surface of different
temperature.
\begin{equation}
\frac{dQ}{dt}=hA\Delta T
\label{newtons-cooling-law}
\end{equation}
where \(h\) is the heat transfer coefficient with \mbox{units \(\left[\frac{W}{m^{2}*K}\right]\)}.

\textbf{Radiation}, the third mechanism of heat transfer, is more
familiar to electrical engineers. In any material, electrons
have discrete amounts of energy based on the wave patterns that can
exist for the atomic geometry. When an electron spontaneously falls
to a less energetic patter, that energy is emitted as a photon of
light.

The classic, physics--history example is black body radiation,
when a metal is heated to high temperature and glows.
A more modern examle is the LED.

The empirical relation for radiation is the Stefan--Boltzmann Law,
which says that the total energy radiated, over all wavelengths
and per unit surface area, is proportional to the fourth power of
the body's temperature.
\begin{equation}
j^{*}=\sigma T^{4}
\end{equation}
where $\sigma$ is a proportionality constant derived from other
constants of nature.

\textbf{Mechanisms \& Media} Usually one mechanism of heat transfer
is dominant in a particular medium, so much so that we can ignore the
other two. Typically this means conduction in solids,
convection in fluids or gas, and radiation in space.
However, sometimes the picture is more complicated including
two cases in an oven:
\begin{enumerate}
	\item At the boundary of metal and air, where conduction
	and convection are both significant.
	\item In a thermocouple loop, where thermal diffusion (convection)
	of electrons is useful despite conduction still being dominant.
\end{enumerate}

\subsection{Thermodynamic Design}
\label{thermodynamic-design-section}

Most microwaves draw between 600 and 1200 Watts of power.
An IR toaster oven may draw 1500 Watts into its lamps.
How much power does \emph{Easy-PCB} need to produce the required temperature profiles?

Our approach for answering this question is to browse available parts on McMaster.com,
imagine how they would be assembled into an oven,
and then model their thermodynamic response using SPICE.

A first conceptual design of \emph{Easy--PCB} is shown in
\hyperref[first-oven-concept]{figure \ref{first-oven-concept}}.

\begin{center}
	\includegraphics[width=\columnwidth]{Figures/first-oven-concept.pdf}
	\captionof{figure}{Concept for Thermodynamic System}
	\label{first-oven-concept}
\end{center}

\subsubsection*{Transmission through Metals \& Insulation}

In the concept, the oven chamber is isolated from the outside with walls of
mineral wool insulation and aluminum.
If the wall is relatively thin compared to the square root of its surface area,
then its heat transfer can be modeled as a 1--D transmission line, like shown in
\hyperref[unidirectional-conduction]{figure \ref{unidirectional-conduction}}.

\begin{center}
\includegraphics[width=0.85\columnwidth]{Figures/unidirectional-conduction.pdf}
\captionof{figure}{Heat Conduction in 1--D}
\label{unidirectional-conduction}
\end{center}

Assuming conduction is the dominant mechanism of heat transfer
and using Fourier's Law in 1--D,
(\hyperref[1D-fouriers-law-eq]{equation \ref{1D-fouriers-law-eq}})
the rate of heat passing through a thin slice is
\begin{equation*}
\frac{\delta Q}{\delta t}=-kA\frac{\delta T}{\delta x}
\end{equation*} 
 
And, from \hyperref[specific-heat-eq]{equation \ref{specific-heat-eq}},
the heat capacity of a thin slice of the metal sheath is
\begin{equation*}
dQ=(\rho A dx)c_{p}dT
\end{equation*}

Rewriting these equations to look like current-voltage relationships gives
\begin{equation}
\delta T=R_{x}\frac{\delta Q}{\delta t},
\quad R_{x}=\frac{\delta x}{kA}
\label{differential-resistance-eq}
\end{equation}
and
\begin{equation}
\frac{\delta Q}{\delta t}=C_{x}\frac{\delta T}{\delta t},
\quad C_{x}=\rho A c_{p} * \delta x
\label{differential-capacitance-eq}
\end{equation}

Values for thermal conductivity $k$, specific heat capacity $c_{p}$, and 
density $\rho$ of different materials are listed in
\hyperref[thermal-properties-table]{table \ref{thermal-properties-table}}.

Long metal bars and rods can also be modeled with equations
\ref{differential-resistance-eq} and \ref{differential-capacitance-eq}
if the heat loss along the length of the bar is assumed to be
negligible compared to heat transfered at the end faces.

\begin{center}
	\includegraphics[width=1\columnwidth]{Figures/bidirectional-conduction.pdf}
	\captionof{figure}{1--D Conduction in Both Directions}
	\label{bidirectional-conduction}
\end{center}

For metal components where heat is injected at the center
of the part and dissipates symmetrically in either direction,
such as the support bar shown in
\hyperref[bidirectional-conduction]{figure \ref{bidirectional-conduction}}
or the metal sheath encasing the heating element,
the surface area can be doubled so that the transmission line
only needs to be integraded in the positive direction.
\begin{equation}
\left\{\begin{array}{c c c}
A_{x}	&\Rightarrow	&2A_{x}	\\
R_{x}	&\Rightarrow	&R_{x}/{2}	\\
C_{x}	&\Rightarrow	&2C_{x}	\\
\{x|-\frac{w}{2} \leq x \leq \frac{w}{2}\}	&\Rightarrow	&\{x|0 \leq x \leq \frac{w}{2}\}	\\
\end{array}\right.
\end{equation}

\begin{table*}
\centering
\caption{Thermal Conductivity, Specific Heat, and Density of Selected Materials}
\begin{tabular}{c | c | c | c | c}
\hline\hline
Material	&Linear Range $(^{o}C)$	&k \(\left(\frac{W}{m*K}\right)\)	&\(c_{p}\) \(\left(\frac{kJ}{kg*K}\right)\)	&\(\rho\) \((kg/m^{3})\)	\\
% Material	k	Cp	density	\\
\hline
Type 6061 Aluminum		&25	&167	&0.896	&2700	\\
Type 304 Stainless Steel	&0--100	&16.2	&0.5	&8000	\\
Cast Iron			&25	&55.0	&0.46	&6800--7800	\\
1.0 K--factor Insulation	&-	&0.1442	&-	&-	\\
0.23 K--factor Insulation	&-	&0.0332	&-	&-	\\
Nichrome NiCr C Alloy		&-	&0.450	&0.135	&8244	\\
Steatite L5 Ceramic		&-	&2.9	&0.92	&2710	\\
\hline\hline
\end{tabular}
\label{thermal-properties-table}
\end{table*}

\subsubsection*{Resistivity of Metal--Air Interface}

In the bulk volume of air, convection is the dominant form of heat
transfer and collisions are relatively rare. However, where the
air meets a solid surface, the net convection must go to zero because
there can be no net movement of air molecules into the solid.
Furthermore, every air molecule that reaches the surface experiences
a collision so there is 100\% conduction at the surface.

For some distance away from the surface, there is a larger than
normal chance of head--on collisions and slower rates of diffusion
due to the nearby wall. In this region, both conduction and convection
may be significant. To analyze this transition region,
we will start at the surface where there is 100\% conduction
because that is the mechanism we have equations for.

From the first law of thermodynamics, the rate of heat being stored
in a differential volume is equal to the rate of heat entering less
the rate of heat leaving the volume element.
\begin{equation*}
\frac{\delta Q_{\textrm{stored}}}{\delta t}=
\frac{\delta Q_{\textrm{in}}}{\delta t}-
\frac{\delta Q_{\textrm{out}}}{\delta t}
\end{equation*}

Looking back at
\hyperref[unidirectional-conduction]{figure \ref{unidirectional-conduction}},
the differential volume element is a plane, so
\begin{equation*}
\frac{\delta Q_{\textrm{stored}}}{\delta t}=
\frac{\delta Q_{x}}{\delta t}-
\frac{\delta Q_{x+\delta x}}{\delta t}.
\end{equation*}

Substituting in
\hyperref[heat-capacity-eq]{equation \ref{specific-heat-eq}}
for stored heat capacity and
\hyperref[1D-fouriers-law-eq]{equation \ref{1D-fouriers-law-eq}} for
conduction through the element yields a transport equation.

\begin{equation}
mc_{p}\frac{\delta T}{\delta t}=kA\frac{\delta T}{\delta x}
\label{transport-eq}
\end{equation}

This cannot be solved analytically unless space and time are independent.
Sorry Albert.
\begin{equation}
T(x\,,t)=T_{x}(x)*T_{t}(t)
\end{equation}

Applying the chain rule to equation \ref{transport-eq}
\begin{equation*}
mc_{p}\frac{\delta T_{t}(t)}{\delta t}T_{x}(x)=
kA\frac{\delta T_{x}(x)}{\delta x}T_{t}(t)
\end{equation*}
and separating variables gives
\begin{equation*}
mc_{p}\frac{\delta T_{t}(t)}{\delta t}*\frac{1}{T_{t}(t)}=
kA\frac{\delta T_{x}(x)}{\delta x}*\frac{1}{T_{x}(x)}.
\end{equation*}

The only way for the equality to be true for all space and time
is if both sides are equal to a common constant.
\begin{equation*}
\alpha=mc_{p}\frac{\delta T_{t}(t)}{\delta t}*\frac{1}{T_{t}(t)}
\end{equation*}
\begin{equation*}
\alpha=kA\frac{\delta T_{x}(x)}{\delta x}*\frac{1}{T_{x}(x)}
\end{equation*}

Each of these can be solved by separation of variables.
\begin{equation*}
\frac{\alpha}{kA}\delta x=\frac{\delta T_{x}(x)}{T_{x}(x)}
\end{equation*}

\begin{equation*}
\frac{\alpha}{kA}\int \delta x=\int \frac{1}{T_{x}(x)}*\delta T_{x}(x)
\end{equation*}

\begin{equation*}
\frac{\alpha x}{kA}=ln\left(T_{x}(x)\right)+\beta_{1}
\end{equation*}

\begin{equation*}
T_{x}(x)=\beta_{1}^{'}e^{\nicefrac{\alpha x}{kA}}
\end{equation*}

Similarly for time,
\begin{equation*}
T_{t}(t)=\beta_{2}^{'}e^{\nicefrac{\alpha t}{mc_{p}}}.
\end{equation*}

Recombining the independent components gives
\begin{equation*}
\Delta T(x\,,t)=\beta_{1}^{'}\beta_{2}^{'}e^{\nicefrac{\alpha x}{kA}+\nicefrac{\alpha t}{mc_{p}}}
\end{equation*}

The boundary conditions are that at $t=0$ and $x=0$, the temperature difference is
the initial temperature difference, and at $t\rightarrow\infty$ and $x\rightarrow\infty$,
the temperature difference dissipates to zero.
\begin{equation*}
\Delta T(x\,,t)=\Delta T_{0}e^{\nicefrac{-\alpha x}{kA}-\nicefrac{\alpha t}{mc_{p}}}
\end{equation*}

Now, for the sake of physical intuition we can write
\begin{equation}
\Delta T(x\,,t)=\Delta T_{0}e^{-(\nicefrac{x}{\delta}+\nicefrac{t}{\tau})},
\label{transport-solution-eq}
\end{equation}
where $\delta$ is a `skin depth' over which the spacial gradient decays to $1/e$ its
initial value and $\tau$ is a time constant related to the skin depth by
\begin{equation}
\tau=\frac{mc_{p}}{kA}\delta.
\label{transport-time-constant-eq}
\end{equation}

Make some arguments and plot the temperature and heat transfer curves.
Assume steady state and somehow that active cooling makes it all valid.

Applying Fourier's law to the temperature profile found in
\hyperref[transport-solution-eq]{equation \ref{transport-solution-eq}},
gives us the rate of heat trasfer in the air due to conduction.
\begin{equation*}
\frac{dQ}{dt}=-kA\frac{dT}{dx}=
\frac{kA}{\delta}\Delta T_{0}e^{-(\nicefrac{x}{\delta}+\nicefrac{t}{\tau})}
\end{equation*}

Again assuming steady state, the rate of heat trasfer at any distance from
the wall is equal to the rate of conduction at the wall.
\begin{equation}
\frac{dQ}{dt}=\frac{kA}{\delta}\Delta T_{0}=h_{c}A\Delta T_{0}
\label{derived-cooling-law-eq}
\end{equation}

This is the information we were after and, ironically, it turns out this is 
Newton's Law of Cooling
(\hyperref[newtons-cooling-law]{equation \ref{newtons-cooling-law}})
where $h_{c}=\nicefrac{k}{\delta}$. Since we do not have any way of predicting
the skin depth except by experimentation, some common values for
the convective heat transfer coefficient $h_{c}$ are listed in
\hyperref[typical-h-values-table]{table \ref{typical-h-values-table}}.

\begin{table}
	\centering
	\caption{Typical Convective Heat Transfer Coefficients}
	\begin{tabular}{c | c | c}
	\hline\hline
	Fluid	&Conv.	&$h_{c}\,\left[\frac{W}{m^{2}*K}\right]$	\\
	\hline
	Gases, \& dry vapors	&free	&$0.5-1000$	\\
				&forced	&$10-1000$	\\
	Water \& liquids	&free	&$50-3000$	\\
				&forced	&$50-10000$	\\
	Boiling Water		&-	&$3-100$	\\
	Condensing $H_{2}O$ Vapor&-	&$5-100$	\\
	\hline\hline
	\end{tabular}
	\label{typical-h-values-table}
\end{table}

\hyperref[derived-cooling-law-eq]{Equation \ref{derived-cooling-law-eq}}
can be rewrittent to look like Ohms' law for SPICE analysis.
\begin{equation}
\Delta T=R_{c}\frac{dQ}{dt},\quad R_{c}=\frac{1}{h_{c}A}=\frac{\delta}{kA}
\label{cooling-resistance-eq}
\end{equation}

\subsubsection*{Heat Capacity of Chamber Air}

The heat capacity of the air in the chamber cannot be analyzed
with constant coefficient assumptions.
\begin{equation}
dQ=m(T)c_{p}(T)dT
\label{specific-heat-with-variable-coefficients-eq}
\end{equation}

\begin{table}
	\centering
	\caption{Thermal Properties of Air}
	\begin{tabular}{c | c | c | c}
\hline\hline
$T\,[^{o}C]$	&$\rho\left[\frac{kg}{m^{3}}\right]$	&$c_{p}\left[\frac{kJ}{kg*K}\right]$	&$k\left[\frac{W}{m*K}\right]$	\\
\hline
20	&1.205	&1.005	&0.0257	\\
40	&1.127	&1.005	&0.0271	\\
60	&1.067	&1.009	&0.0285	\\
80	&1.000	&1.009	&0.0299	\\
100	&0.946	&1.009	&0.0314	\\
120	&0.898	&1.013	&0.0328	\\
140	&0.854	&1.013	&0.0343	\\
160	&0.815	&1.017	&0.0358	\\
180	&0.779	&1.022	&0.0372	\\
200	&0.746	&1.026	&0.0386	\\
250	&0.675	&1.034	&0.0421	\\
300	&0.616	&1.047	&0.0454	\\
\hline\hline
	\end{tabular}
	\label{air-properties-table}
\end{table}

From \hyperref[air-properties-table]{table \ref{air-properties-table}},
we can see that the specific heat of air does not vary much over the
temperature range of the oven; less than 0.3\% from $c_{p(20^{o}C)}$
over the range $20-300^{o}C$. However, the density and mass of air
in the chamber may change significantly.

Assuming that the air in the chamber behaves like an ideal gas
and is made up of the normal percentages of $N_{2}$, $O_{2}$, $CO_{2}$, etc., then mass and temperature are related by
\begin{equation*}
PV=\frac{m}{M}RT\quad\Rightarrow\quad m(T)=\frac{MPV}{R}T
\end{equation*}
where the ideal gas constant is
\begin{equation*}
R=5.00745\,\left[\frac{\textrm{atm}*\textrm{in}^{3}}{\textrm{mol}*K}\right]
\end{equation*}
and the molar mass of air is
\begin{equation*}
M=28.97\,\left[\frac{g}{\textrm{mol}}\right]
\end{equation*}

For the first oven concept in
\hyperref[first-oven-concept]{figure \ref{first-oven-concept}},
the volume of the chamber is fixed in natural units of $in^{3}$
and there are likely small leaks that let the chamber
pressure equilibrate to atmospheric pressure $1\,\textrm{atm}$.

Substituting $m(T)$ into
\hyperref[specific-heat-with-variable-coefficients-eq]
{equation \ref{specific-heat-with-variable-coefficients-eq}},
converting from absolute Kelvin scale to Celsius, and
manipulating to look like a current--voltage relationship results in
\begin{equation}
\frac{dQ}{dt}=C_{c}(T)\frac{dT}{dt}
\end{equation}
where
\begin{equation}
C_{c}(T)=\frac{c_{p(20^{o}C)}MPV}{R(T+273.16^{o}C)}.
\label{bulk-air-capacitance-eq}
\end{equation}

Equivalently,
\begin{equation*}
C_{c}(T)=\frac{\left(5.8143\left[\frac{J}{in^{3}}\right]\right)*V}{T+273.16^{o}C}.
\end{equation*}

\subsubsection*{Variable Capacitor for Chamber Air}

Unfortunately, SPICE does not have a primitive circuit element for
a variable capacitor.
Before simulating and iterating the oven design, we must build a
SPICE subcircuit to model heat capacity of ideal gasses.
The subcircuit black box must have two terminals with I--V relation
\begin{equation*}
i_{c}=C(v_{c})\frac{dv_{c}}{dt},
\label{capacitor-iv-relation}
\end{equation*}
or, alternatively,
\begin{equation}
\int i_{c}dt=\int C(v_{c})dv_{c}.
\label{capacitor-integrated-iv-relation}
\end{equation}

The left side of \hyperref[capacitor-integrated-iv-relation]
{equation \ref{capacitor-integrated-iv-relation}} is an integrator,
which can be implemented with a buffer and a capacitor.
For the SPICE circuit shown in
\hyperref[variable-capacitance-circuit]{figure \ref{variable-capacitance-circuit}},
the integrated current is proportional to the voltage of
the `int' node.
\begin{equation*}
\int i_{c}dt=C_{\textrm{int}}*v_{int}
\end{equation*}

\begin{center}
	\includegraphics[width=1\columnwidth]{Figures/variable-capacitance-circuit.pdf}
	\captionof{figure}{Voltage Variable Capacitor in SPICE}
	\label{variable-capacitance-circuit}
\end{center}

For the right side of
\hyperref[capacitor-integrated-iv-relation]
{equation \ref{capacitor-integrated-iv-relation}},
it can be solved for the variable heat capacitance
of an ideal gas found in
\hyperref[bulk-air-capacitance-eq]{equation \ref{bulk-air-capacitance-eq}}.
\begin{equation*}
\begin{array}{c l}
\int C(v_{c})dv_{c}	&=\frac{c_{p}MPV}{R}\int\frac{dv_{c}}{v_{c}+273.16}	\\
&\\
&=\frac{c_{p}MPV}{R}ln(v_{c}+273.16)+A	\\
\end{array}
\end{equation*}

Recombining the left and right halves gives
\begin{equation*}
C_{int}v_{int}=\frac{c_{p}MPV}{R}ln(v_{c}+273.16)+A,
\end{equation*}
which can be solved to find a nonlinear expression
for a dependent source $v_{c}$.

Solving...
\begin{equation*}
\frac{RC_{int}}{c_{p}MPV}*v_{int}=ln(v_{c}+273.16)+A
\end{equation*}

\begin{equation*}
v_{c}=A^{'}e^{\nicefrac{v_{int}}{B}}-273.16
\end{equation*}

Finally, applying boundary conditions $v_{c}(0)=0$ and $v_{int}(0)=0$ gives
\begin{equation}
v_{c}=273.16\left(e^{\nicefrac{v_{int}}{B}}-1\right)
\end{equation}
where constant $B$ is
\begin{equation}
\begin{array}{c c l}
B&=&\frac{c_{p}MP}{R}*V*C_{int}\\
&&\\
&=&\left(5.8413\left[\frac{J}{in^{3}}\right]\right)*V*C_{int}\\
\end{array}
\end{equation}
and $V$ is the constant volume of air.

\begin{table}
	\centering
	\caption{Nichrome Wire Properties (NiCr C)}
	\begin{tabular}{c | c c c c}
\hline
Composition	&59.2\%Ni	&16\%Cr	&23.5	&1.3	\\
Resistivity ($\rho$)	&$675*\pi$	&$\left[\frac{\Omega*\textrm{mil}^{2}}{ft}\right]$	&\%Fe	&\%Si	\\
Melting Pt.	&1350	&$[^{o}C]$	&	&	\\
\hline\hline
Temp. [$^{o}C$]	&20	&93	&204	&315	\\
\% $\rho$ Increase	&0	&1.7	&3.5	&5.2	\\
\hline
	\end{tabular}
	\label{nichrome-properties-table}
\end{table}

\subsection{Design Iteration \& SPICE Modeling}

Many designs with different shapes, sizes, metals, insulators,
heating elements, and wattage levels were modeled in SPICE for their
thermodynamic response to a unit step signal from the power relay.
The primary parameters of interest was the heating rate of the air
in the chamber.

The SPICE models were based on the equations from
\hyperref[thermodynamic-design-section]{section \ref{thermodynamic-design-section}};
material properties from tables \ref{thermal-properties-table}, \ref{typical-h-values-table},
\ref{air-properties-table}, and \ref{nichrome-properties-table}; and
geometry of the design.
Unitwise, $1\,\textrm{Volt}=1^{o}C$, $1\,\textrm{Ampere}=1\,\textrm{Watt}$,
\mbox{and $1\,\textrm{Coulomb}=1\,\textrm{Joule}$.}

Eventually a design using 28 ft of 45 mil nichrome wire inside a 8"x8"x12"
aluminum frame was selected.

The shape of the aluminum frame is shown in
\mbox{\hyperref[aluminum-frame-concept]{figure \ref{aluminum-frame-concept}}}.
The inside of the frame is lined with 1" thick mineral wool insulation,
leaving an inside chamber with dimensions 6"x6"x10".
A fan is mounted in the back.

\begin{figure}
	\centering
	\includegraphics[width=\columnwidth]{Figures/aluminum-frame-concept.pdf}
	\caption{Aluminum Frame Concept}
	\label{aluminum-frame-concept}
\end{figure}

Inside the frame, the nichrome wire is mounted using high temperature
ceramic spacers for electrical insulation. Structurally, the nichrome
element is tensioned by two size 10 steel bolts spanning the width of the
chamber, as shown in
\mbox{\hyperref[heating-element-concept]{figure \ref{heating-element-concept}}}.
Direct contact between the nichrome heating element and the chamber air
is critical for fast heating rates.

\begin{figure}
	\centering
	\includegraphics[width=\columnwidth]{Figures/heating-element-concept.pdf}
	\caption{Heating Element Concept}
	\label{heating-element-concept}
\end{figure}

The thermodynamic model is shown in
\hyperref[thermodynamic-spice-circuit]{figure \ref{thermodynamic-spice-circuit}}.

DISCUSSION/MATH OF MODEL VALUES

\begin{figure*}
	\centering
	\includegraphics[width=0.8\textwidth]{Figures/thermodynamic-spice-circuit.pdf}
	\caption{Thermodynamic SPICE Model Circuit Diagram}
	\label{thermodynamic-spice-circuit}
\end{figure*}

The circuit netlist passed to SPICE is listed in
\hyperref[heat-model-listing]{section \ref{heat-model-listing}}.
The circuit was modeled for its transient reponse if the heating element
were connected to 120 VAC power for 100 second.
The results are shown in
\hyperref[heat-model-results]{figure \ref{heat-model-results}}.

\begin{figure}
	\centering
	\includegraphics[width=1\columnwidth]{Figures/heat-model-results.pdf}
	\caption{Simulated Temperature Response to a Unit Step}
	\label{heat-model-results}
\end{figure}

\subsection{Plant Bill of Materials}

\section{User Interface Design}

\subsection{Separate, Front--Facing PCB}

The user interface is designed to be assembled on a separate PCB
from the main controller board. This separation allows the high power
components to be mounted on the back of the oven---far away from the user.
Thus, the user interface PCB is mounted near the door and has no
voltages greater than 12 V for safety. Everything on the front PCB
is shown in blue in \emph{Easy--PCB} block diagram.

\begin{center}
	\includegraphics[width=\columnwidth]{Figures/control-system.pdf}
	\captionof*{figure}{The \emph{Easy--PCB} Control System: not just a controller bolted onto a disjoint oven.}
\end{center}

The user interface board contains a 4--digit, 7--segment, common--cathode
display and a matching common--cathode driver. The display driver
is connected to the controller board via 4 wire serial peripheral interface (SPI).
From the MAX7219 datasheet, the worst case current draw by the display driver
is
\begin{equation}
I_{\textrm{LED Display}}<200\,mA.
\end{equation}

There are 6 active low
pushbuttons on the front facing board with 6 corresponding low pass filters
on the controller board. The pushbutton circuit is shown in
\hyperref[pushbutton-circuit]{figure \ref{pushbutton-circuit}}.

\begin{figure}
	\centering
	\includegraphics[width=0.8\columnwidth]{Figures/pushbutton-circuit.pdf}
	\caption{Hardware Debounced Pushbuttons}
	\label{pushbutton-circuit}
\end{figure}

An audio alarm is provided by a 2 kHz piezoelectric element and a small BJT
amplifier circuit, like shown in
\hyperref[piezo-circuit]{figure \ref{piezo-circuit}}.

\begin{figure}
	\centering
	\includegraphics[width=0.7\columnwidth]{Figures/piezo-circuit.pdf}
	\caption{Piezo Alarm}
	\label{piezo-circuit}
\end{figure}

Finally, there is a safety switch that is compressed when the door is closed.

\subsection{Stop Button and Door Contact}

The door contact safety switch on the front--facing PCB board is form A: normally open and active closed.
The safety switch and the stop button are connected to interupt pins on the microcontroller.
When activated, the interupt routine will turn off power to the nichrome heating element
and the program will quit the current run routine.

INTERUPT ROUTINE ON STATE DIAGRAM?

\subsection{Bill of Materials}

\section{Temperature Feedback Design}

To develop accurate temperature control, real time temperature feedback
is necessary. The temperature is too hot for thermisters or temperature ICs,
so old school thermocouples must be used.

\begin{center}
	\includegraphics[width=\columnwidth]{Figures/control-system.pdf}
\end{center}

\subsection{Thermocouple \& Amplifier}

\begin{figure*}
	\centering
	\begin{circuitikz}[scale=.75]\draw
		(3,0) node [circ] (kn) {} to [R, l=$R_{f1}$] (6,0)
		(3,.25) node [] {$K_{N}$}
		(2.5,-1) node [circ] (kp) {$\,K_{P}$} to (2.5,-1.5) node [ground] {}
		(6,0) to (6,1.5) to [R, l=$R_{f2}$] (10,1.5) to (10,-.5)
		(8,-.5) node [op amp] (opamp) {}
		(6,0) node [circ] {} -- (opamp.-)
		(opamp.out) to (11,-.5) node [ocirc] {~to ADC}
		(opamp.+) -- (6,-1) to (6,-1.5) node [ground] {};
		\draw (.5,.5) node [] {K--Thermocouple};
		\draw (0,-.25) -- (.25,0) -- (.75,-.5) -- (1.25,0) -- (1.75,-.5) -- (2.5, -.5) -- (kp);
		\draw (0,-.25) -- (.25,-.5) -- (.75, 0) -- (1.25,-.5) -- (1.75,-0) -- (kn);
	\end{circuitikz}
	\caption{Thermocouple Amplifier}
	\label{thermocouple-amplifier}
\end{figure*}

The Seebeck voltage is the electromotive force that develops due to temperature
gradient in a conductive loop made of two different metals. It is described by
\begin{equation}
E_{S}=\int _{TR}^{T}\alpha_{A,B}dT,
\end{equation}
where $T$ and $T_{R}$ are the temperatures of the hot and cold junctions and
$\alpha_{A,B}$ is the Seebeck coefficient between materials $A$ and $B$.

A type--K thermocouple was selected because they are readily available and
resist oxidation at temperatures up to $1260^{o}C$.
From the `Manual on the use of Thermocouples in Temperature Measurement' \mbox{(STP 470A)}, the nominal
Seebeck coefficients for type--K thermocouples is
\begin{equation}
\alpha_{KP,KN}=\left\{\begin{array}{c c}
0^{o}C		&39.4\,\mu V/^{o}C	\\
200^{o}C	&40.0\,\mu V/^{o}C	\\
400^{o}C	&42.3\,\mu V/^{o}C	\\
\end{array}\right..
\end{equation}

The positive wire $KP$ is one of the following alloys: Chromel, Tophel, T--1, or ThermoKanthal KP.
The negative wire $KN$ is Alumel, Nial, T--2, or ThermoKanthal KN.

The thermoelectric potential in a K loop is very small; 
for a temperature difference of $T-T_{R}=500^{o}C$,
the voltage developed is only on the order of $E_{S}=20\,mV$.
Consequently, the signal needs to be amplified before it can be read by and ADC.
The op amp circuit shown in
\hyperref[thermocouple-amplifier]{figure \ref{thermocouple-amplifier}}
can be used.

Five volt $\mu$controllers usually have ADC ranges of 0--3.3 V.
To scale $20\,mV$ to $3.3\,V$ and $0\,V$ to $0\,V$, the feedback resistors
should be
\begin{equation*}
	\frac{R_{f2}}{R_{f1}}=
	\frac{V_{\textrm{ADC(max)}}}{V_{\textrm{K(max)}}}=
	\frac{3.3\,V}{20\,mV}
\end{equation*}
\begin{equation}
R_{f2}=165*R_{f1}
\end{equation}

\subsection{Bill of Materials}

\section{Motor Driver Design}

\subsection{Bipolar Motor Selection}

The combination of needing motors and relays and already being plugged in to a 
120 VAC source led to the decision to create a 12 V power rail. The 12 V rail
will only be used by components that are not particularly affected by a noisy
signal, so this rail does not need active regulation.

With a 12 V rail in mind, there are many more choices for motors to drive the fan.
A bipolar stepper motor was chosen because of its open speed control in low torque applications.

\begin{center}
	\includegraphics[width=0.25\textwidth]{Figures/bipolar-motor.pdf}
	\captionof{figure}{Bipolar Stepper Motor}
\end{center}

The 44M100D2B motor by Portescap rotates $3.6^{o}$ per change in polarity--i.e. 100 step increments,
according to the polarities in
\hyperref[44M100D2B-polarities]{table \ref{44M100D2B-polarities}}.

\begin{table}
\centering
\caption{Step Polarites for 44M100D2B Motor}
\begin{tabular}{c | c | c | c | c | c}
\hline\hline
CW	&Step	&Red (1)&Gry (2)&Yel (3)&Blk (4)	\\
\hline\hline
\verb1|1	&1	&+	&-	&+	&-	\\
\verb1|1	&2	&+	&-	&-	&+	\\
\verb1|1	&3	&-	&+	&-	&+	\\
v		&4	&-	&+	&+	&-	\\
\hline\hline
\end{tabular}
\label{44M100D2B-polarities}
\end{table}

\begin{table}
\centering
\caption{44M100D2B Electrical Specifications}
\begin{tabular}{c | c }
\hline\hline
&Bipolar	\\
\hline\hline
DC Operating Voltage	&$12V$	\\
Resistance per Winding	&$70\Omega$	\\
Inductance per Winding	&$35mH$	\\
Rated Current per Phase	&$\nicefrac{12V}{70\Omega}=0.17A$	\\
\hline\hline
\end{tabular}
\end{table}

\subsection{Push-Pull Driver Design}

The driving circuit for the bipolar motor must be capable if pulling 
each winding lead to either side of the supply; the classic
`H--Bridge' circuit.
A good implementation is with push-pull BJTs because they can be
cutoff to save power when they are not needed.
\hyperref[motor-driver-circuit]{Figure \ref{motor-driver-circuit}}
shows the push--pull H--bridge for one of the two motor windings.
An identical copy is needed for the other motor winding.

A microcontroller can only output up to 5V, with limited current, so
$Q_{5-9}$ are needed to help bias the push--pull transistor inputs.
From \hyperref[44M100D2B-polarities]{table \ref{44M100D2B-polarities}},
if the motor is on then each side of the winding needs opposite
polarity. Because of this,
$Q_{5}$ and $Q_{6}$ are arranged as a differential amplifier
to reduce the number of PWM pins needed from the microcontroller.
The constant current source from $Q_{7-9}$ allows the circuit to be turned
off to conserve power.

\begin{figure*}
	\centering
	\includegraphics[width=.65\textwidth]{Figures/motor-driver-circuit.pdf}
	\caption{Push-Pull Driver Circuit for a Bipolar Motor}
	\label{motor-driver-circuit}
\end{figure*}

To design the driver, the electric properties of the motor windings
and symmetric NPN/PNP BJTs are needed.
The resistor networks should were chosen such that switching $V_{in}$ from
0 to 5 V causes $Q_{5}$ and $Q_{6}$ to alternate cutoff and saturation.

From the winding resistance of the motor, the saturation current through
$Q_{1-4}$ and the maximum current for which the flyback diodes must be rated is
\begin{equation}
I_{sat}=\frac{12\,V}{70\,\Omega}=171\,mA.
\end{equation}
\begin{equation}
P_{sat}=IV=171\,mA*12\,V=2\,W
\end{equation}

\subsection{Driver SPICE Simulation}

The circuit in
\hyperref[motor-driver-circuit]{figure \ref{motor-driver-circuit}}
was simulated in SPICE with the net listed in
\hyperref[motor-driver-listing]{section \ref{motor-driver-listing}}.
Five volt step functions were applied to both $V_{on}$ and $V_{in}$ to simulate the microcontroller.
The results in 
\hyperref[motor-driver-voltage-simulation]{figure \ref{motor-driver-voltage-simulation}}
and
\hyperref[motor-driver-current-simulation]{figure \ref{motor-driver-current-simulation}}
show how motor loads the power supply.

\begin{figure}
	\centering
	\includegraphics[width=0.75\columnwidth]{Figures/motor-driver-voltage-simulation.pdf}
	\caption{Simulated Voltages across One Driver}
	\label{motor-driver-voltage-simulation}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.9\columnwidth]{Figures/motor-driver-current-simulation.pdf}
	\caption{Simulated Current through One Driver}
	\label{motor-driver-current-simulation}
\end{figure}

\subsection{Bill of Materials}

\begin{table*}[ht]
\centering
\caption{Thur-hole BJTs and Diodes}
\begin{tabular}{c c c c c c}
\hline\hline
Label	&Man. Part No.	&Manufacturer	&Doping	&$h_{fe}$	&$I_{C(max)}$ or $I_{o}$	\\
\hline\hline
$Q_{1}$, $Q_{2}$	&\href{datasheets/MPSA06(TO-92).pdf}{MPSA06-AP}	&Micro Commercial Co	&NPN	&100	&500mA	\\
$Q_{3}$, $Q_{4}$	&\href{datasheets/MPSA55-MPSA56(TO-92).pdf}{MPSA56-AP}	&Micro Commercial Co	&PNP	&100	&500mA	\\
$Q_{5-9}$	&\href{datasheets/2N3904(TO-92).pdf}{2N3904-AP}	&Micro Commercial Co	&NPN	&100	&200mA	\\
$D_{1-4}$	&\href{datasheets/1N4001-1N4007(DO-41).pdf}{1N4007-TP}	&Micro Commercial Co	&Standard PN	&N/A	&1A	\\
\hline\hline
\end{tabular}
\end{table*}

\section{Power Circuit Design}

The power circuit is shown in
\hyperref[power-circuit]{figure \ref{power-circuit}}.

\begin{figure*}
	\centering
	\includegraphics[width=0.75\textwidth]{Figures/power-circuit.pdf}
	\caption{Power Circuit Design}
	\label{power-circuit}
\end{figure*}

For safety, the relay is form A so it is normally off.
The amplifier BJT and flyback diode should be rated for currents greater than the saturation
current of the relay coil.
\begin{equation}
I_{\textrm{Diode Rating}}>I_{\textrm{Relay Sat.}}=\frac{V_{\textrm{DC Coil Rating}}}{R_{coil}}
\end{equation}

For the Omron Safety G4W relays, the saturation current is
\begin{equation}
I_{\textrm{Relay Sat.}}=66.7\,mA\quad\textrm{at }12\,V
\end{equation}

\subsection{PCB Trace Width}

The minimum width and clearance for high current, high voltage traces
on a PCB can be calculated using
\begin{equation}
I=0.048[A]*\left(\frac{\Delta T}{[^{o}C]}\right)^{0.44}*\left(\frac{A}{[mil^{2}]}\right)^{0.725}
\label{trace-width-eq}
\end{equation}
and
\begin{equation}
\textrm{Clearance}=0.023[in]+\frac{0.0002[in]}{[V]}*V_{\textrm{peak}}
\end{equation}
from the design standard for PCB trace width ANSI/IPC--2221. Note that
equation \ref{trace-width-eq} is only for exterior traces.

For $10\,A$, $120\,VAC$ power with a maximum temperature rise of $10^{o}C$
and standard copper thickless $1\,oz=1.4\,mil$, the minimum trace width
is $0.278\,in$ and minimum clearance is $0.057\,in$.

\section{Controller Design}

A flowchart of the microcontroller program is shown in
\hyperref[program-flowchart]{figure \ref{program-flowchart}}.

\begin{figure}
	\centering
	\includegraphics[width=0.75\columnwidth]{Figures/program-flowchart.pdf}
	\caption{Microcontroller Program Flowchart}
	\label{program-flowchart}
\end{figure}

\appendix

\section{SPICE Netlists}

\subsection{Thermodynamic Model}
\label{heat-model-listing}
\lstinputlisting[basicstyle=\small, float=*]{NGSPICE/Thermo/heat-model.cir}

\subsection{Bipolar Motor Driver}
\label{motor-driver-listing}
\lstinputlisting[basicstyle=\small, float=*]{NGSPICE/Motor-Driver/motor-driver.cir}

\end{document}
